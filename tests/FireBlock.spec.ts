import {BasePath, Fireblocks, TransactionOperation, TransferPeerPathType} from "@fireblocks/ts-sdk";
import path from "path";
import fs from "fs";

require('dotenv').config();


const apiSecretPath = process.env.FIREBLOCKS_API_SECRET_PATH;
const apiKey = process.env.FIREBLOCKS_API_KEY;
const vaultAccountId = process.env.FIREBLOCKS_DEPLOYER_VAULT_ACCOUNT_ID;

describe('test the fireblocks api', () => {

    it('test the demo api', async () => {

        console.log(apiSecretPath)
        console.log(apiKey)
        console.log(vaultAccountId)

        const assetId = "TON_TEST";

        const fireblocksKeyPath = path.join(process.cwd(), apiSecretPath!);
        const privateKey = fs.readFileSync(fireblocksKeyPath, "utf8");

        const sdk = new Fireblocks({
            secretKey: privateKey,
            apiKey,
            basePath: BasePath.US,
        });

        const content = getImplementationDeploymentData();
        console.log(content)
        const response = await sdk.transactions.createTransaction({
            transactionRequest: {
                operation: TransactionOperation.Raw,
                source: {type: TransferPeerPathType.VaultAccount, id: vaultAccountId},
                assetId,
                extraParameters: {
                    rawMessageData: {
                        messages: [{
                            content,
                            bip44AddressIndex: 0
                        }
                        ]
                    }
                },
                note: "Deploy wusd jetton contract raw signing test",
            },
        });


        console.log(response);

    })


    it('test the get transaction api', async () => {
        const fireblocksKeyPath = path.join(process.cwd(), apiSecretPath!);
        const privateKey = fs.readFileSync(fireblocksKeyPath, "utf8");

        const sdk = new Fireblocks({
            secretKey: privateKey,
            apiKey,
            basePath: BasePath.US,
        });
        const txId = "78f837ae-4efb-4423-9a45-e3e6a7c1f93f";
        const fbTx = await sdk.transactions.getTransaction({txId})

        console.log(fbTx)

    })


})


export function getImplementationDeploymentData(): string {

    const message = "aba1230bfb6792ec877aa0136814eee7fc9282f1e6054d82a9a8e560bd45a1993a92ec261784ec25b28474f81f01158771392a2b67fdc6e7553dbbdab7ee1f6a44c38fe83aa79ab38aa83657290beb7dcb24220d418d2cace8ce3c2edae1d788bfccd71ac527e710fce6cd4493514294d638b59dff1432c8f1aa6ee9d09ff42a465cf5cf5705619aca65b334e153d8a9731c3dd306ea2f828fb6724fb88674e8b28f8ea2725d658a7be9e819d80de13a4bf6ed707f55d957d6110cc1fea89c95d570969e686dc0c3ef847c3bdf8e9931c825d22a63e4441d06398b0208e0a2261fd67a30fd5387dbcbcf1ffd1be519c27e4ec9865b71e96402190347bcc7b9f5db72585fba207780dd1f0aefea679cfa6e25a019d727146af2eabe3a0eea83563337a85292642409630ec51074dcd7801ed0bff08f6d188978e274c89256ab90570566a04c51000ef78b3c67628b02b5aaffbfebe88dea1301c8d1ab503cce74d3bbca1962265d9031350c2d6cf4ef43427d2c9156fd075971030b59af7a3dd0cd09d2054ceab3b0df5ecfb6f288fa45718d5b4207fea513fe12a041058dc662eba44ecb5176885de26c8543ac38173571872794b3aea1b924743612d8df8013d0e65d4a8903dde2778a2e7314772bc783068edbdb3dfd39177d6c0be06c6cb0ca39d04fe8d6ffc1be0574907deea325027b1c1b242ebce682d76836b0b59ebc0f56f6ea2108b1a0285dd1e008014f9bc666c9344d095f3bda54459188f0043c3f5134e433aab079d23558c317696ee7c120ad9aa77bc6dc33aca415682e7d0f278db2c0d401561418263996ed52ed7c19c38bfab1aa0bffb1c49d2a35441b61e41c95522e8f1e39be7f745ba74fce37475b55769e5674a409023f9aed488da1c29fcf8540d0c540e8d991923dcda9fa558ef68c8e75f814427ab7cc6b93b18eb2930c04822ac4302e1b56572cfd1f23560c8574db074836c42bd816b266823e5b24d8eaa965d70e7dbbf7d7fa94e212b280a3d46492eca332c142a8a80876bd224737b64ae783a45c365ec7e6c9f1e1aa9a2416bdf56b7d42b01c164c7f254c24a8a2948fdc65d7703072a57e9a9c8f6eb4bbef15efeff86b2de7627fe2ac7a17946f121cc4e35eb26cb4ac52fcf4c9385ee557b77b55db036ebe7e63cb41090cf7b5e4dcf312ca0668b16781b636ab69a73df2577ff17812086c4c872637326286c5eff9611a05e329c6bb12f5936e0d9bc0112293682e249311017caab8557a959acd7a3a7b0fe2cc03d4845ff4491773520bf578d025a37b5d56d7075d70084e3ca821247e813d8a5225a98b8336b3d2c058b970c99dee2992eab7a5512477370a93da7186f9dfbba26fdd63b4ebe0c1bb45a4d948acd4797acdf54706ff5fbc526a1a3e8a204776c941e84c00e3e7dfbf6eb71141648155aa86ce8e00399ab6e5405b6a0842be5ba37c1b9585ceee8483486ad5607413894dbca183194a9dc92ffc465bad04032727ce9884e2e61e1310da7f12f620906eaf20173ea0e887ef6537eeb87a8839729e4aedf4f1acc7601c2a27baa236b4e1c063fe2a6f0aba691422f707f802156a79f53a57b20789797164a9a0eae965fb6191ebaf87753406df06feedd086dd732b5fc59cb5e92a266cfe86952620739543caace50b623d43e939d7104aeff81b79411c8c58e7963c976175929ae0033b6cbb382abb71d53273bcf6c2e4263dc0519439b7db9b3a6d0c3394334dd2240d00c7b4f64bcda364665b756560265e9f4b52a1a09acefe273570ddc5c8558ec04c6a3734859d64f00f226aac80eaa9a737e1d175d455f74d57b3b7da40d879d562348b1cae3fcbaef78e774e362d877618e8fc998757640be0b68c9df1d58372b099174620f5ea0e08abf31a960b9468b845f7fc31b37ad28a6a1a115b18e475ea32a8fe6cdb24fe1f7632dc89834349df37d7543ce57dd6a6c9c0376b54d6781ececfb7495d1455f8eb07ff651d9142bb309fb0f9c68f13b479dfebb70c448006be897bb8cccf6b298ab0c7927b6d7a1b6bea1fff4847a040bccd604429dfc965b8e34836b461d44d84b20c075716aa1b0f00bc2e94decbd8cd43f993f894b2d93443fe28b27f6206a38b47dd32f993eaff7b82e33b4c8e478af4068c946923f89e0d577013de618296a0f2585aa0a8d03ef6e1062c301a27f57864e4f05d29f6fd30868b91d4ea71a62263543b205b1b0f59a0518ca033c5a1f7dfdd85e732394ac9d0348e2386c0a11fbc3cfef08d02d1b75c2f53bf73fd90c134717a50085ac1c022b1515193490e768bd9440968f312ae068c5afc97580daae8f0b878768de04dbb1c643a550ec34254f3bbe462dcc26ca717c9824d32a894e1eb83425d8991fb9e161ca44ca1949010ffc74eb84f13ff4f1689c08d99abf74182d63f5c0a783c407291319d6820fcb31217e4817f733746ace050e10d25bdc4d65e144ad1193e320d2b76fc56db05bdc4c54ba89a1af7eb21355e0a10b617ebc2dbac70c84f667be13b2fb4d8bfc88e241f60a084ec0a1eb8b671ff1377a1f5d458864ae7cfc6a19ceff65b71fcf6335c6df59a589120ea8c60dca211a7af3f1bdc0209193b7b154f8045c880c4fc80986ec7a62a22a6f8b32fe4096879ede0c981c5efeaf55ac8bc292e68089e417610b0dedb49d0d4beb70faf34bd9a60d1b7672424ca670587594aa18fd09c727a2048f2cb5004a64a2d0205f35ab8e977f2730dec1112a1a74448fd50a4964a8b31b100586339a0c8d44f7d4f926850c991f7e040ce6c251d766cf620429765ea3c2523c72d6491659ca695daf2063f793e2908cafe6793792ae7aecf6785937bad6d857138a4a57e02db52e8b143b96d41a06c023456de2cfb9cd24a06386e4f1060704693cf5717db681855c14fbaf9ac5396eb9e424a317e3833d4e9daa504ec8d31f379a6fd51afa5b43a146a666aac6849bc0048252c3342097d61e1e4c547542847b46294882b25c6ea429fc2e50830fb310e08204dbc4650de6d8a91cbb0895a16bad8ffc9a89842ea20e658efa25a5fde3aab2792af5f77ee49392d63a17802b422b53fd6d52c1cf70ba97e68b6f4ceeb4ee67bdbe0a50913e1f062e81323fd0b11d8f90ec6d4935b8ae9031386665ba83f20773018aaaba14dcc6e48f699562bd2007956244529ce2b401e022ded9c308ddf6e8325247c711f12df025b0896f163bc35c4c87d600a089b720dcd813577dca3d49ae38f496d467c5b8c50bee7cf149749f3dfe0e91babdae0ac8a5bed2bbb0b98b04dde25d4b34f6183ff76f22e14fb36c31afd2efa468ab678af14b596066b553dabaf58d845e12a338caf39e539e7d666447775db83f4749105733ec8026b101ba992471308e9b00ebb2ff13e8ad6b03979f6251455959572615c28346d63e870cd8af4ac051dcc6755e2ad2ac99923e5f88d1444f8c26a6b7efa3ff608af04e3d0c03b0a85c52f70a15a0c41cef86d658b34aabebb4d355d5392b179b6c704740afd47cb8865d4103cfd89e0607c1cd5297799d6f5ad0c077883391faf94ffa8f09e44ef24d1e460f2b5b39765de37f6ce78d0a8f3bc5b20fb7d7a5a8b47fbe903b441177f8d8093695c1ccd47b24becb23b63233e1439960b1ce0fe0e7594658bbe0056f9950726a686ad87d2fb894b2c074c8e124c8c59a71e9009fcb6a99c3232d0b4419d0649c7be55d7b6b8d665332c02e01434cd01496120c9d10ee34c1553e43301ba7c866999804d41958f4f398b1c89d8cce8226c18b04e1211d50364fd9cfb29cd43f21b530df75fefbfa03734f5b68e32b21eddbab161f9b48b92e044eae1f566c8663d8e677186395d575a8e1ea14f019b01186c1a73f6620f668cf3fdf22e4ef8b44be201193b6e86f4a73ab0a5eac89ac2b17d737a96239ad3fb41fcc5c4caf39526098e2be9c0b44a0dea91753c65e3fa3c16a26a9899540e122f181f7ce1f6a59ee8d1464737701de90cefbc1475f98cec97ee9834dc36ac3c67f4b52e44d8ad4048e982f588d11d82a23b7911b4db9129f3c329b8949aff69b9f1141342882a66c0a8e7486d27f3e1c717a7058e7bb4519115e32a498e717cc87c7069e4f4f873898625a35d581157a380274d25ff74fe7e4fb8bf37ed5f8294efddea9d5674cb5bb59d47617561270fc8f92b61305e92679b0b4712c7ce16b710bb26f534734821c1b8607c39044f4ad47cca06484299c7bf9c37eed008d7161f4ae3f2b310dc4bc73e294083f92d82ab3cac309fb62f59aacda9d562c4e076d11343578b3bf992d08d385b4ce653";

    return message;
}